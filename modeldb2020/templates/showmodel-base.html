{% extends "bigleftcol.html" %}
{% load static %}
{% block head %}




    <style>
        .indented {
            margin-left: 2em;
        }
        .btn2 {
            color: black !important;
            background-color: lightblue !important;
        }
        .btn2:hover {
            color: white !important;
            background-color: blue !important;
        }
        .btn3:hover {
            color: black !important;
            background-color: blue !important;
        }
        .thin>li>a {
            padding: 5px 10px !important
        }
    </style>
    {% if access == "rw" %}
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    {% endif %}

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/> 
    <script src='{% static "three.js" %}'></script>
    <script src='{% static "plotshape.js" %}'></script>
    <script src='{% static "MeshLines.js" %}'></script>
    <script src='{% static "ThreeContainer.js" %}'></script>
    <!--is manage.py the server code? we will see-->

    <script>
        var _shape_plots = [];
        
        $.getJSON(`/api/v1/morphology/{{Model.id}}`, function(data) {
            console.log(data)
            //var parsed = JSON.parse(data)
            //console.log(parsed)
            //so you don't need to parse it if you're ajax querying it?
       
        
        var geo = 1;
        $(function() {
            _shape_plots = [new ShapePlot($("#shapeplot"))];

            //setup geo
            var geo1 = data;
            var geo2 = [[[0, 2], [0, 0], [0, 0], [0.5, 0.5], [0, 2]],
                    [[2, 4], [0, 2], [0, 0], [0.5, 0.5], [2, 2+2*Math.sqrt(2)]]];

            var max_dist = 350;
            set_neuron_section_data([geo1, max_dist]);
            vdata = [42.813552007268925,
                    -54.038185372855786,
                    41.761579318909796,
                    39.41993559836059,
                    34.99648160473037,
                    33.3403321668553,
                    23.622783930473712,
                    39.805462385242045,
                    34.12194773432393,
                    20.554186533666556,
                    21.1266030365248,
                    12.413765722830583,
                    -2.6755479085545897,
                    34.925760768934644,
                    39.224018912195476,
                    39.72425585659378,
                    40.536835519404555,
                    39.98224274634862,
                    38.377877484039104,
                    34.68179411978869,
                    40.18982642373176,
                    33.40217779509267,
                    39.111988282704104,
                    35.00571038906414,
                    34.06977615403649,
                    37.9624366966187,
                    20.049826988804547,
                    37.72491380339506,
                    40.90550923770404,
                    41.51364914323725,
                    40.12692068876319,
                    39.52650569131693,
                    38.13181995867464,
                    33.18005445244575,
                    39.99047050090586,
                    40.86304946091724,
                    35.915218899257,
                    33.952762373969534,
                    33.11847567400142,
                    -12.985148088334984,
                    1.1458224016580005,
                    -28.973163042765492,
                    -31.190064677665898,
                    29.00761906965428,
                    34.02454421727653,
                    17.85205807381681,
                    40.35897387589386,
                    32.475602008578754,
                    10.586222043525243,
                    30.222776307925184,
                    32.966416481815145,
                    32.28774489283922,
                    30.26242577587877,
                    35.89475293225422,
                    35.49305529631652,
                    40.52315420692357,
                    40.22695916070555,
                    35.479337769489646,
                    39.874148159490524,
                    38.12128678674264,
                    39.95406022284439,
                    37.2639756923053,
                    36.07671059975131,
                    35.286424295064926,
                    34.93494172495186,
                    34.95853440229918,
                    35.020792961604755,
                    35.068244376808735,
                    35.138572641380684,
                    35.155100666711895,
                    35.16220668045297,
                    35.233369652903434,
                    35.23820555855143,
                    35.11111434927856,
                    33.9337130503387,
                    31.914566083543207,
                    30.87161983162127,
                    29.3920529701028,
                    28.373101130536625,
                    26.96166281875891,
                    24.387103739143633,
                    22.328671447022575,
                    20.284528228862413,
                    16.935296189094796,
                    14.618120938159226,
                    7.730910729900874,
                    -1.7594593571940589,
                    -7.899351921369451,
                    -16.060659329330193,
                    -19.89714910640034,
                    -22.094534416132667,
                    -26.316020159683468,
                    -32.627359561799096,
                    -54.511462637287615,
                    -62.23454255880327,
                    -62.28348385102342,
                    -60.65407018517971,
                    -43.178480956490446,
                    -62.10669286139166,
                    -61.549733376636745,
                    -39.451273532117256,
                    -61.39912768661631,
                    -64.26551510883414,
                    -64.3947928437423,
                    -54.73163257320294,
                    -57.53512359962439,
                    -60.833423970552246,
                    -44.64229290826089,
                    -44.98240144298284,
                    -58.29950071669003,
                    -59.11860491216132,
                    -64.16214555440602,
                    -64.06316731628334,
                    -52.18933138990245,
                    -24.856893926385084,
                    -39.46525466149135,
                    13.097677325691375,
                    -9.904357547027615,
                    -26.37952488583006,
                    -33.711960205211646,
                    -40.337974970747105,
                    -2.2599579516616943,
                    -41.645874883977555,
                    -23.796316337461676,
                    -36.45963265510422,
                    29.37460950261265,
                    14.823261706147385,
                    10.125299637514976,
                    -22.36203000636819,
                    32.285043122208286,
                    31.84747506859133,
                    33.06663648259064,
                    -30.682097433009424,
                    35.07778316488294,
                    35.53777112902124,
                    19.183562924365688,
                    28.392312482882453,
                    35.448154453935395,
                    38.55695398395291,
                    39.90008946946701,
                    21.531805444315847,
                    38.111267852798264,
                    28.478611672799936,
                    28.753570222018933,
                    35.446617428639264,
                    36.85452173642988,
                    21.66706556045496,
                    -5.843545864795723,
                    35.36262376106164,
                    41.12295962456605,
                    39.67446278087012,
                    38.7799913005781,
                    41.073982395850486,
                    35.04651390298852,
                    35.6999874393235,
                    40.85407295869078,
                    38.58546449064538,
                    40.17059926064113,
                    40.960205606040525,
                    35.88763331823419,
                    38.512995477314114,
                    39.26843476529821,
                    34.99042138796838,
                    35.562396492990096,
                    40.50367327408374,
                    37.85773916722887,
                    40.02480886021876,
                    41.107131431917445,
                    34.56802218638961,
                    36.975349479938274,
                    39.660712193618025,
                    39.55005100035831,
                    37.46168644955252,
                    36.21762200521573,
                    36.63965996238619,
                    37.95590591625114,
                    39.159845655556985,
                    40.17407808620075,
                    40.73199948324956,
                    37.115587692525885,
                    40.54659704595352,
                    41.08944472220014,
                    37.9497664092956,
                    35.41740512278135,
                    38.38843330293944,
                    40.7277277800689,
                    40.53961261933676,
                    41.024383176343434,
                    38.69370865807514,
                    36.34934532105759,
                    36.10519590127988,
                    41.187832674735,
                    40.922409432890674,
                    37.132249298847995]
                    
                    
            
            $("#toggle_diam").click(function() {
                $('#shapeplot').attr('data-mode', 1 - $('#shapeplot').attr('data-mode')); 
                _shape_plots[0].force_update();
            });

            $("#toggle_color").click(function() {
                var color_b = new THREE.Color( 0x000000 );
                var color_r = new THREE.Color( 0x0000ff );
                var min = Math.min.apply(Math, vdata);
                var max = Math.max.apply(Math, vdata);
                var i;
                for (i = 0; i < 500; i++) {
                    let line = _shape_plots[0].tc.lines[i]; 
                    meshcolor = line.material.color;
                    meshcolor.set(color_b);
                }

                
            });

            $("#toggle_sections").click(function() {
                if (geo == 1) {
                    geo = 2;
                    set_neuron_section_data([geo2, max_dist]);
                } else {
                    geo = 1;
                    set_neuron_section_data([geo1, max_dist]);
                }
            });
        });

    });
    </script>
{% endblock %}

{% block header %}
  {% include "showmodel-tabs.html" %}
{% endblock %}

{% block sidecolumn %}
<div class="well">
<<<<<<< HEAD
    
    {% if not Model.data_to_curate %}
        
    {% if '{{Model.id}}.json' %}
    <div id="shapeplot" data-mode='1' class="mw-100 mh-100" style="width:600px; height: 400px; border: 2px rgb(31, 44, 44) solid">
    </div>
    <div align="center">
        <button class="btn" id="toggle_diam" type="button">Show Diameter</button>
    </div>
    
   
    {% endif %}


=======
    {% if not Model.data_to_curate and not tab == 2 %}
        {% if tab != 4 or data.by_location %}
        
        {% endif %}
>>>>>>> 517f49653f6e46547648196c91a7b367f8438f5b
    {% else %}
        <a href="/forget_access?model={{Model.id}}" class="btn btn2">Forget access</a>
    {% endif %}
    <div>
        {% block belowshapeplot %}
        {% endblock %}
    </div>
</div>

{% endblock %}
